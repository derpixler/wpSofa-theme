{"version":3,"sources":["webpack:///./template-parts/player/assets/js/player.js","webpack:///./template-parts/player/assets/js/customPlayerOptions.js"],"names":["applyfilters","require","localstorageHandle","hash","mediaPlayer","options","storage_key","currentPos","selectors","player","controls","startStop","progressBar","progressBarStatus","duration","doFilter","then","helloStr","console","log","this","players","cacheTime","collectPlayers","length","addEvents","self","selector","document","querySelectorAll","forEach","call","playerControls","playerSources","audio","querySelector","sourcesNodes","source","type","getAttribute","currentTime","push","node","sources","update","map","event","addEventListener","e","playStop","currentTarget","seek","timeupdate","playStopElem","btn","classes","classList","contains","remove","add","play","get","pause","playerTimeUpdater","currTimeElem","percent","Math","floor","style","width","dataset","progress","src","setAttribute","split","innerText","formatSecondsAsTime","secs","hr","min","sec","mouse","offsetX","offsetWidth","module","exports","addFilter","resolve","custom"],"mappings":"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","file":"player-js.chunk.js","sourcesContent":["/**\n * here comes the wpSofa podcast media player\n */\n\nconst applyfilters = require( 'applyfilters' );\nconst localstorageHandle = require( '@web-dev-media/localstorage' );\nconst hash = require( 'object-hash' );\n\nclass mediaPlayer {\n\tconstructor() {\n\t\tlet options = {\n\t\t\tstorage_key: 'wpsofa-player-storage',\n\t\t\tcurrentPos : 0,\n\t\t\tselectors  : {\n\t\t\t\tplayer  : '.player',\n\t\t\t\tcontrols: {\n\t\t\t\t\tstartStop        : '.media-action',\n\t\t\t\t\tprogressBar      : '.progress',\n\t\t\t\t\tprogressBarStatus: '.progress .status',\n\t\t\t\t\tduration         : '.status'\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\tapplyfilters.doFilter( 'mediaPlayerOptions', options ).then((helloStr) => {\n\t\t\treturn options;\n\t\t});\n\n\t\tconsole.log(options);\n\t\tthis.options = options;\n\n\n\t\tthis.players = [];\n\n\t\tlocalstorageHandle.options.cacheTime = -1;\n\n\t\tthis.collectPlayers();\n\n\t\tif ( this.players.length > 0 ) {\n\t\t\tthis.addEvents();\n\t\t}\n\t}\n\n\t/**\n\t * registers a function  that use a filter/hook 'this.doFilter()'\n\t * this function can modify the code execution or data\n\t *\n\t * @param {string} filterName\n\t * @param {string} callback\n\t * @param {number} priority\n\t * @return {void}\n\t */\n\tcollectPlayers() {\n\t\tlet self = this;\n\n\t\tif ( self.options.selectors ) {\n\t\t\tlet selector = self.options.selectors.player;\n\n\t\t\tif ( selector ) {\n\t\t\t\tlet players = document.querySelectorAll( selector );\n\n\t\t\t\t[].forEach.call( players, function( player ) {\n\t\t\t\t\tlet playerControls = {};\n\t\t\t\t\tlet playerSources = {};\n\n\t\t\t\t\tlet audio = player.querySelector( 'audio' );\n\t\t\t\t\tlet sourcesNodes = audio.querySelectorAll( 'source' );\n\n\t\t\t\t\tif ( sourcesNodes ) {\n\t\t\t\t\t\t[].forEach.call( sourcesNodes, function( source ) {\n\t\t\t\t\t\t\tlet type = source.getAttribute( 'type' );\n\t\t\t\t\t\t\tplayerSources[ type ] = source.getAttribute( 'src' );\n\t\t\t\t\t\t} );\n\n\t\t\t\t\t\tfor ( selector in self.options.selectors.controls ) {\n\t\t\t\t\t\t\tplayerControls[ selector ] = player.querySelector( self.options.selectors.controls[ selector ] );\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tplayerControls.currentTime = player.querySelector( '.current-time' );\n\n\t\t\t\t\t\tself.players.push( {\n\t\t\t\t\t\t\tnode        : player,\n\t\t\t\t\t\t\taudio       : audio,\n\t\t\t\t\t\t\tcontrols    : playerControls,\n\t\t\t\t\t\t\tsources     : playerSources,\n\t\t\t\t\t\t\tsourcesNodes: sourcesNodes,\n\t\t\t\t\t\t\thash        : hash( playerSources )\n\t\t\t\t\t\t} );\n\t\t\t\t\t}\n\n\t\t\t\t} );\n\t\t\t}\n\t\t}\n\t}\n\n\taddEvents() {\n\t\tif ( this.players ) {\n\t\t\tthis.players.forEach( player => {\n\t\t\t\tlocalstorageHandle.update( player.hash + '_isPlaying', false );\n\n\t\t\t\t[ 'play', 'pause', 'timeupdate' ].map( event => {\n\t\t\t\t\tplayer.audio.addEventListener( event, ( e ) => this[ event ]( player ) );\n\t\t\t\t} );\n\n\t\t\t\tplayer.controls.startStop.addEventListener( 'click', ( e ) => this.playStop( e.currentTarget, player ) );\n\t\t\t\tplayer.controls.progressBar.addEventListener( 'click', ( e ) => this.seek( e, player ) );\n\n\t\t\t\tthis.timeupdate( player );\n\t\t\t} );\n\t\t}\n\t}\n\n\tplayStop( playStopElem, player ) {\n\t\tlet btn = playStopElem.querySelector( 'div' );\n\t\tconst classes = {\n\t\t\tplay : 'play',\n\t\t\tpause: 'pause'\n\t\t};\n\n\t\tif ( btn.classList.contains( classes.play ) ) {\n\t\t\tbtn.classList.remove( classes.play );\n\t\t\tbtn.classList.add( classes.pause );\n\n\t\t\tplayStopElem.classList.remove( classes.play );\n\t\t\tplayStopElem.classList.add( classes.pause );\n\n\t\t\tplayer.audio.play();\n\t\t\tplayer.audio.currentTime = localstorageHandle.get( player.hash + '_currentTime' );\n\t\t\tlocalstorageHandle.update( player.hash + '_isPlaying', true );\n\t\t} else {\n\t\t\tbtn.classList.remove( classes.pause );\n\t\t\tbtn.classList.add( classes.play );\n\n\t\t\tplayStopElem.classList.remove( classes.pause );\n\t\t\tplayStopElem.classList.add( classes.play );\n\n\t\t\tplayer.audio.pause();\n\t\t\tlocalstorageHandle.update( player.hash + '_isPlaying', false );\n\t\t}\n\t}\n\n\tplay( player ) {\n\t\tthis.playerTimeUpdater( player );\n\t}\n\n\tpause( player ) {\n\t\tthis.playerTimeUpdater( player );\n\t}\n\n\ttimeupdate( player ) {\n\t\tlet currentTime = player.audio.currentTime ? player.audio.currentTime : localstorageHandle.get( player.hash + '_currentTime' );\n\t\tlet duration = player.audio.duration ? player.audio.duration : localstorageHandle.get( player.hash + '_duration' );\n\n\t\tif ( currentTime ) {\n\t\t\tlet currTimeElem = player.controls.currentTime;\n\t\t\tlet percent = Math.floor( (\n\t\t\t\t100 / duration\n\t\t\t) * currentTime );\n\n\t\t\tplayer.controls.progressBarStatus.style.width = percent + '%';\n\n\t\t\tif ( percent > 85 ) {\n\t\t\t\tcurrTimeElem.dataset.progress = \"85\";\n\t\t\t} else if ( percent > 70 ) {\n\t\t\t\tcurrTimeElem.dataset.progress = \"70\";\n\t\t\t} else if ( percent > 45 ) {\n\t\t\t\tcurrTimeElem.dataset.progress = \"45\";\n\t\t\t} else if ( percent > 15 ) {\n\t\t\t\tcurrTimeElem.dataset.progress = \"15\";\n\t\t\t} else {\n\t\t\t\tcurrTimeElem.dataset.progress = \"0\";\n\t\t\t}\n\n\t\t\tif ( localstorageHandle.get( player.hash + '_isPlaying' ) === true && duration != null ) {\n\t\t\t\tlocalstorageHandle.update( player.hash + '_currentTime', player.audio.currentTime );\n\t\t\t\tlocalstorageHandle.update( player.hash + '_duration', player.audio.duration );\n\t\t\t}\n\n\t\t\t[].forEach.call( player.sourcesNodes, function( source ) {\n\t\t\t\tlet src = source.getAttribute( 'src' );\n\t\t\t\tsource.setAttribute( 'src', src.split( '#' )[ 0 ] + '#t=' + currentTime );\n\t\t\t} );\n\n\t\t\tthis.playerTimeUpdater( player );\n\t\t}\n\t}\n\n\tplayerTimeUpdater( player ) {\n\t\tlet currTimeElem = player.controls.currentTime;\n\t\tlet currentTime = player.audio.currentTime ? player.audio.currentTime : localstorageHandle.get( player.hash + '_currentTime' );\n\n\t\tif ( currentTime ) {\n\t\t\tcurrTimeElem.innerText = this.formatSecondsAsTime( currentTime );\n\t\t}\n\t}\n\n\tformatSecondsAsTime( secs ) {\n\t\tvar hr = Math.floor( secs / 3600 );\n\t\tvar min = Math.floor( (\n\t\t\tsecs - (\n\t\t\thr * 3600\n\t\t\t)\n\t\t) / 60 );\n\t\tvar sec = Math.floor( secs - (\n\t\t\thr * 3600\n\t\t) - (\n\t\t\tmin * 60\n\t\t) );\n\n\t\tif ( min < 10 ) {\n\t\t\tmin = \"0\" + min;\n\t\t}\n\t\tif ( sec < 10 ) {\n\t\t\tsec = \"0\" + sec;\n\t\t}\n\t\tif ( hr < 10 ) {\n\t\t\thr = \"0\" + hr;\n\t\t}\n\n\t\treturn hr + ':' + min + ':' + sec;\n\t}\n\n\tseek( mouse, player ) {\n\t\tlet percent = mouse.offsetX / player.node.offsetWidth;\n\t\tplayer.audio.currentTime = percent * player.audio.duration;\n\n\t\tlocalstorageHandle.update( player.hash + '_currentTime', player.audio.currentTime );\n\t\tlocalstorageHandle.update( player.hash + '_duration', player.audio.duration );\n\n\t\tthis.timeupdate( player );\n\t}\n}\n\nexports = module.exports = mediaPlayer;","const applyfilters = require( 'applyfilters' );\n\napplyfilters.addFilter('mediaPlayerOptions', (resolve, options) => {\n\toptions.custom = 4;\n\tresolve(options);\n}, 1);"],"sourceRoot":""}