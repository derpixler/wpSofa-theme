/*! For license information please see player-js.chunk.js.LICENSE */
(window.webpackJsonp=window.webpackJsonp||[]).push([["player-js"],{"./template-parts/player/assets/js/fetchFeedpressHits.js":function(e,t,s){var a=s("./node_modules/applyfilters/applyFilters.js"),o=s("./node_modules/object-hash/dist/object_hash.js"),r=s("./node_modules/@web-dev-media/localstorage/index.js");a.addFilter("mediaPlayerCollection",(function(e,t){!function(e){mediaPlayerCollectionLength=e.length,postIds=[];var t=function(t,s){s=s||!1,(t=JSON.parse(JSON.parse(t)))&&e.forEach((function(e){var s=e.node.parentNode.querySelectorAll(".hitsCount");e.hits=t[e.postId],s.forEach((function(s){s.innerText&&(s.innerText=t[e.postId])}))}))};if(mediaPlayerCollectionLength>0){e.forEach((function(e){var t=e.node.parentNode,s=null!=t?t.dataset.postId:null;s&&void 0===e.hits&&(postIds.push(s),e.postId=s)}));var s=r.get("fetchedHits_"+o(postIds)+"_timestamp"),a=Date.now()-s>36e5?null:r.get("fetchedHits_"+o(postIds));if(!a&&postIds.length>0){var n=new XMLHttpRequest;n.onreadystatechange=function(){4===n.readyState&&(r.update("fetchedHits_"+o(postIds),n.responseText),r.update("fetchedHits_"+o(postIds)+"_timestamp",Date.now()),t(n.responseText))},n.open("POST",window.wpsofa.rest_url+"wpffph/v1/hits"),n.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),n.send("ids="+postIds.join(","))}else t(a,!0)}}(t),e()}),1)},"./template-parts/player/assets/js/likeEpisode.js":function(e,t,s){var a=s("./node_modules/applyfilters/applyFilters.js"),o=s("./node_modules/@web-dev-media/localstorage/index.js");a.addFilter("mediaPlayerObject",(function(e,t){!function(e){if(e){var t=o.get(e.hash+"_episode_liked"),s=e.node.parentNode.querySelector(".episodeLike");void 0!==e.likes&&e.likes;console.log({before:e.likes}),e.likes||new Promise((function(t,a){var o=new XMLHttpRequest;o.onreadystatechange=function(){4===o.readyState&&(s.innerHTML=o.responseText.replace('"',"").replace('"',""),e.likes=JSON.parse(o.responseText),t())},o.open("POST",window.wpsofa.rest_url+"wpsofa/v1/like_post/get"),o.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),o.send("id="+e.node.parentNode.dataset.postId)})),null===t?s&&s.addEventListener("click",(function(){null===o.get(e.hash+"_episode_liked")&&new Promise((function(t,a){var r=new XMLHttpRequest;r.onreadystatechange=function(){4===r.readyState&&(s.innerHTML=JSON.parse(r.responseText),s.classList.remove("icon-star-regular"),s.classList.add("icon-star-solid"))},r.open("POST",window.wpsofa.rest_url+"wpsofa/v1/like_post/put"),r.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),r.send("id="+e.node.parentNode.dataset.postId),o.update(e.hash+"_episode_liked",!0)}))})):(s.classList.remove("icon-star-regular"),s.classList.add("icon-star-solid"))}}(t),e()}),1)},"./template-parts/player/assets/js/player.js":function(e,t,s){function a(e,t){for(var s=0;s<t.length;s++){var a=t[s];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var o=s("./node_modules/applyfilters/applyFilters.js"),r=s("./node_modules/@web-dev-media/localstorage/index.js"),n=s("./node_modules/object-hash/dist/object_hash.js"),i=function(){function e(){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),void 0===window.wpsofa.player){var t={storage_key:"wpsofa-player-storage",currentPos:0,selectors:{player:".player",controls:{startStop:".media-action",progressBar:".progress",progressBarStatus:".progress .status",duration:".status"}}};o.doFilter("mediaPlayerOptions",t).then((function(){return t})),this.options=t,this.players=[],r.options.cacheTime=-1,this.collectPlayers(),this.players.length>0&&(window.wpsofa.player=this.players,this.addEvents(),o.doFilter("mediaPlayerCollection",this.players).then((function(){return t})))}}var t,s,i;return t=e,(s=[{key:"collectPlayers",value:function(){var e=this;if(e.options.selectors){var t=e.options.selectors.player;if(t){var s=document.querySelectorAll(t);[].forEach.call(s,(function(s){var a={},r={},i=s.querySelector("audio"),l=i.querySelectorAll("source");if(l){for(t in[].forEach.call(l,(function(e){var t=e.getAttribute("type");r[t]=e.getAttribute("src")})),e.options.selectors.controls)a[t]=s.querySelector(e.options.selectors.controls[t]);a.currentTime=s.querySelector(".current-time");var d={node:s,audio:i,controls:a,sources:r,sourcesNodes:l,hash:n(r)};o.doFilter("mediaPlayerObject",d).then((function(){return d})),e.players.push(d)}}))}}}},{key:"addEvents",value:function(){var e=this;this.players&&this.players.forEach((function(t){r.update(t.hash+"_isPlaying",!1),["play","pause","timeupdate"].map((function(s){t.audio.addEventListener(s,(function(a){return e[s](t)}))})),t.controls.startStop.addEventListener("click",(function(s){return e.playStop(s.currentTarget,t)})),t.controls.progressBar.addEventListener("click",(function(s){return e.seek(s,t)})),e.timeupdate(t)}))}},{key:"playStop",value:function(e,t){var s=e.querySelector("div"),a="play",o="pause";s.classList.contains(a)?(s.classList.remove(a),s.classList.add(o),e.classList.remove(a),e.classList.add(o),t.audio.play(),t.audio.currentTime=r.get(t.hash+"_currentTime"),r.update(t.hash+"_isPlaying",!0)):(s.classList.remove(o),s.classList.add(a),e.classList.remove(o),e.classList.add(a),t.audio.pause(),r.update(t.hash+"_isPlaying",!1))}},{key:"play",value:function(e){this.playerTimeUpdater(e)}},{key:"pause",value:function(e){this.playerTimeUpdater(e)}},{key:"timeupdate",value:function(e){var t=e.audio.currentTime?e.audio.currentTime:r.get(e.hash+"_currentTime"),s=e.audio.duration?e.audio.duration:r.get(e.hash+"_duration");if(t){var a=e.controls.currentTime,o=Math.floor(100/s*t);e.controls.progressBarStatus.style.width=o+"%",a.dataset.progress=o>85?"85":o>70?"70":o>45?"45":o>15?"15":"0",!0===r.get(e.hash+"_isPlaying")&&null!=s&&(r.update(e.hash+"_currentTime",e.audio.currentTime),r.update(e.hash+"_duration",e.audio.duration)),[].forEach.call(e.sourcesNodes,(function(e){var s=e.getAttribute("src");e.setAttribute("src",s.split("#")[0]+"#t="+t)})),this.playerTimeUpdater(e)}}},{key:"playerTimeUpdater",value:function(e){var t=e.controls.currentTime,s=e.audio.currentTime?e.audio.currentTime:r.get(e.hash+"_currentTime");s&&(t.innerText=this.formatSecondsAsTime(s))}},{key:"formatSecondsAsTime",value:function(e){var t=Math.floor(e/3600),s=Math.floor((e-3600*t)/60),a=Math.floor(e-3600*t-60*s);return s<10&&(s="0"+s),a<10&&(a="0"+a),t<10&&(t="0"+t),t+":"+s+":"+a}},{key:"seek",value:function(e,t){var s=e.offsetX/t.node.offsetWidth;t.audio.currentTime=s*t.audio.duration,r.update(t.hash+"_currentTime",t.audio.currentTime),r.update(t.hash+"_duration",t.audio.duration),this.timeupdate(t)}}])&&a(t.prototype,s),i&&a(t,i),e}();e.exports=i}}]);
//# sourceMappingURL=player-js.chunk.js.map